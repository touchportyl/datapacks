#summon minecraft:item ~ ~ ~ {Motion:[0.0,0.2,0.0],PickupDelay:40,Item:{id:"minecraft:conduit",Count:1,tag:{DD_Linked:1b,display:{Name:'{"text":"Entangled Conduit","color":"light_purple","italic":false}',Lore:['','{"text":"This conduit\'s quantum state","color":"gray","italic":false}','{"text":"is entangled to a dimensional","color":"gray","italic":false}','{"text":"door","color":"gray","italic":false}','{"text":" "}','{"text":"Quantum state: ","color":"dark_gray","italic":false,"extra":[{"text":"entangled","color":"dark_gray","obfuscated":true}]}']}},components:{custom_data:{DD_Linked:1b},custom_name:'{"text":"Entangled Conduit","color":"light_purple","italic":false}',lore:['{"text":"This conduit\'s quantum state","color":"gray","italic":false}','{"text":"is entangled to a dimensional","color":"gray","italic":false}','{"text":"door","color":"gray","italic":false}','{"text":" "}','{"text":"Quantum state: ","color":"dark_gray","italic":false,"extra":[{"text":"entangled","color":"dark_gray","obfuscated":true}]}']}},Tags:["DimensionalDoors","DD_generateLink","DD_particleLink"],custom_data:["DimensionalDoors","DD_generateLink","DD_particleLink"]}

execute if score FLAG$nbt.version.old DatapackManager = BOOL$true DatapackManager run summon minecraft:item ~ ~ ~ {Motion:[0.0,0.2,0.0],PickupDelay:40,Item:{id:"minecraft:conduit",Count:1,tag:{DD_Linked:1b,display:{Name:'{"text":"Entangled Conduit","color":"light_purple","italic":false}',Lore:['','{"text":"This conduit\'s quantum state","color":"gray","italic":false}','{"text":"is entangled to a dimensional","color":"gray","italic":false}','{"text":"door","color":"gray","italic":false}','{"text":" "}','{"text":"Quantum state: ","color":"dark_gray","italic":false,"extra":[{"text":"entangled","color":"dark_gray","obfuscated":true}]}']}}},Tags:["DimensionalDoors","DD_generateLink","DD_particleLink"]}

execute if score FLAG$nbt.version.old DatapackManager = BOOL$true DatapackManager as @e[tag=DD_generateLink] store result entity @s Item.tag.DD_doorID int 1 run scoreboard players get DD$doorID.current DD_doorID

# special case for 1.20.3 to 1.20.6
execute if score FLAG$nbt.version.1.20.3 DatapackManager = BOOL$true DatapackManager run summon minecraft:item ~ ~ ~ {Motion:[0.0,0.2,0.0],PickupDelay:40,Item:{id:"minecraft:conduit",Count:1,components:{custom_data:{DD_Linked:1b},custom_name:'{"text":"Entangled Conduit","color":"light_purple","italic":false}',lore:['{"text":"This conduit\'s quantum state","color":"gray","italic":false}','{"text":"is entangled to a dimensional","color":"gray","italic":false}','{"text":"door","color":"gray","italic":false}','{"text":" "}','{"text":"Quantum state: ","color":"dark_gray","italic":false,"extra":[{"text":"entangled","color":"dark_gray","obfuscated":true}]}']}},custom_data:["DimensionalDoors","DD_generateLink","DD_particleLink"]}

execute if score FLAG$nbt.version.1.20.3 DatapackManager = BOOL$true DatapackManager as @e[tag=DD_generateLink] store result entity @s Item.components.minecraft:custom_data.DD_doorID int 1 run scoreboard players get DD$doorID.current DD_doorID


execute as @e[tag=DD_generateLink] run tag @s remove DD_generateLink